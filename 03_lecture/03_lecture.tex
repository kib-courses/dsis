\input{./../header/kib.tex}
\input{./../header/user.tex}

\title{Лекция 3. RSA Risk Engine, RSA Rules Engine}
% \date{\today}
\date{8 октября 2019}
\author{Павел Владимирович Слипенчук}
\institute{Москва, МГТУ им.Бауманка,\\ каф.ИУ-8, КИБ}
% \titlegraphic{\includegraphics[width=2cm]{logo_ur.jpg}}
\titlegraphic{\small \href{https://github.com/kib-courses/dsis}{Data Science для решения задач информационной безопасности}}

\begin{document}
  \maketitle
    
\begin{frame}{План лекции}
    \begin{enumerate}
		\item \nameref{section:feedback}
		\item \nameref{section:rsa_feedback}
	\end{enumerate}
\end{frame}

\section{Обратная связь}\label{section:feedback}

\begin{frame}{Историческая заметка}
	\begin{columns}
		\begin{column}{0.5\textwidth}
			\includegraphics[width=5cm]{../pic/anohin.jpg}
		\end{column}
		\begin{column}{0.6\textwidth}
			\begin{enumerate}
				\item В 1935 году советский физиолог
				Пётр Кузьмич Анохин формулирует понятие обратной связи.
				\item Термин «перекочевал» в Кибернетику (1948) Н.Винера
				\item В настоящее время термин «обратная связь» используется в медицине, в технике, в акустике, в биологии, в социальных науках.
			\end{enumerate}
		\end{column}
	\end{columns}
\end{frame}

\begin{frame}{Обратная связь в DS}
	\termdef{Обратная связь (feedback) I}  --
	это любая информация, используемая для оценки качества ЭС
	и/или для получения новой \term{обучающей выборки} (или выборки \term{обучения с подкреплением})
	
	\termdef{Обратная связь (feedback) II} -- это процесс, система, 
	программный модуль, реализующий обратную связь I
\end{frame}

\begin{frame}{Обучение с подкреплением, reinforcement learning (Дообучение, Refitting)\footnote{слайд из лекции №2}}
	\small
	Есть первоначальная обучающая выборка: 
	\begin{equation*}
		U_{fit} = \left\{ y \mapsto \bold x  \right\}
	\end{equation*}
	Первоначальное обучение:
	\begin{equation*}
		score_1 := fit (U_{fit}) 
	\end{equation*} 
	В дальнейшем при получении нового множества $\hat U_{fit}$ (возможно состоящее из одного элемента)
	мы дообучаем систему:
	\begin{equation}
		score_{i+1} := refit (\hat U_{fit}, score_{i}) 
	\end{equation} 
	Таким образом функция $score_i$ заменяется на новую функцию $score_{i+1}$.
\end{frame}

\begin{frame}{Итеративное обучение}
	\small
	Есть первоначальная обучающая выборка: 
	\begin{equation*}
	\hat U_1 = U_{fit} = \left\{ y \mapsto \bold x  \right\}
	\end{equation*}
	Первоначальное обучение:
	\begin{equation*}
	score_1 :=   fit (\hat U_{1}) = fit (U_{fit}) 
	\end{equation*} 
	В дальнейшем при получении нового множества $\hat U_{i}$ (возможно состоящее из одного элемента)
	мы повторно обучаем систему:
	\begin{equation}
	score_{i+1} := fit ( U_{fit} \cup \hat U_2 \cup ... \cup  \hat U_{i}) 
	\end{equation} 
	Таким образом функция $score_i$ заменяется на новую функцию $score_{i+1}$.
\end{frame}

\begin{frame}
	\auditorium{Верно ли утверждение что итеративное обучение позволяет для любого алгоритма
	осуществить обучение с подкреплением?}
\end{frame}

\begin{frame}{Стабильность. <<Цепочка>>}\label{frame:chain_score}
	Есть итеративная система обучения и имеем скоринги:
	\begin{equation*}
	score_{i-n} := fit ( \hat U_{1} \cup \hat U_2 \cup ... \cup  \hat U_{i-n} \cup ... \cup \hat U_{i-1} \cup \hat U_{i}) 
	\end{equation*}
	\begin{equation*}
	...
	\end{equation*}
	\begin{equation*}
	score_{i-1} := fit ( \hat U_{1} \cup \hat U_2 \cup ... \cup  \hat U_{i-1} \cup \hat U_{i}) 
	\end{equation*}
	\begin{equation*}
	score_{i} := fit ( \hat U_{1} \cup \hat U_2 \cup ... \cup  \hat U_{i}) 
	\end{equation*}
	
	Тогда задав веса $w_j > 0$ можно сделать простой ансамбль вида:
	\begin{equation*}
	\bold {score_{i}}(\bold x) = \frac{w_1 \cdot score_{i-n}(\bold x) + ... + w_n \cdot score_{i}(\bold x)}{\sum_{j=1}^{n} w_j} 
	\end{equation*}
	
	Например:
	\begin{equation*}
	\bold {score_{i}}(\bold x) = 
		0.2 \cdot score_{i-2}(\bold x) 
		+ 0.3 \cdot score_{i-1}(\bold x) 
		+ 0.5 \cdot score_{i}(\bold x) 
	\end{equation*}
\end{frame}


\begin{frame}
	Возвращаемся к обратной связи
	\Large
	\begin{center}
		\auditorium{Зачем нужна обратная связь в DS?}
	\end{center}
\end{frame}

\begin{frame}
	Feedback позволяет:
	\begin{enumerate}
		\item Изменить $score$ на основании предыдущих \term{откликов}
		и размеченных данных. Например при каждой сработке 
		можно с вероятностью $p$ проводить расследование и дообучать систему.
		\item генетические алгоритмы: изменение параметров
		\item позволяет выявлять аномалии\footnote{<<аномалитика>> :) },
		корректировать мат.модель, выбирать из ML моделей лучшую.
	\end{enumerate}
\end{frame}


\section{RSA. Обратная связь}\label{section:rsa_feedback}

\begin{frame}{Общая схема} 
	\includegraphics[width=11.5cm]{../pic/expert_system_rsa.png}
	% \includegraphics[width=5cm]{../pic/anohin.jpg}	
\end{frame}

\begin{frame}{Последовательность}
	
	\begin{enumerate}
		\item Выбираются данные за $T=90$ дней.
		% \item Выбираются <<фиксированные>> данные.
		\item Строится 
	\end{enumerate}

\end{frame}

\begin{frame}{Обратная связь. Сработки системы}\label{frame:rsa_feedback}
\includegraphics[width=11.5cm]{../pic/expert_system_rsa_feedback.png}
\end{frame}


\begin{frame}{Обратная связь. Жалобы}
	Если у клиента украли деньги и он это заметил, последовательность следующая:
	\begin{enumerate}
		\item клиент пишет жалобу/звонит/иным способом сообщает это
		\item специальный человек проверяет корректность жалобы. 
		Если она корректна, то данные помещаются как F.
	\end{enumerate}
	
	Контактный центр принимает звонки при всех \textbf{REVIEW} операциях.
	\auditorium{Если клиент не позвонил, какие выводы?}
	
	При \textbf{DENY} операциях проводятся специальные расследования с помощью 
	особого подразделения внутри самого банка.
\end{frame}

\begin{frame}{CUSTOM\_MARK}\label{frame:custom_mark}
	Маркировка проходит вручную.
	\begin{itemize}
		\item СUSTOM\_MARK=U (Uknoun) – неизвестная транзакция
		\item СUSTOM\_MARK=G (Genuine\footnote{RSA олдскульная система. Вместо флага L(legitim) в ней используется флаг G}) – подлинная
		\item СUSTOM\_MARK=F (Fraud) – фродовая
		\item СUSTOM\_MARK=S (Suspicious) – скорее всего фродовая
		\item СUSTOM\_MARK=A (Authentic) – скорее всего подлинная
		\item CUSTOM\_MARK=Null – не промаркировано.
	\end{itemize}
\end{frame}


\begin{frame}{Определение класса}
	По  СUSTOM\_MARK определяется класс транзакции:
	\begin{itemize}
		\item 0 -- легитимная
		\item 1 -- мошенническая
		\item x -- не используется
	\end{itemize}
	
	\begin{tabular}{|l|l|l|}
		\hline
		СUSTOM\_MARK & класс & Примечание \\ \hline
		U & x & \\ \hline
		G & 0 & \small помечаются транзакции всей сессии\\ \hline
		F & 1 & \small помечаются транзакции всей сессии\\ \hline
		S & 1 & \\ \hline
		A & 0 & \\ \hline
		Null & 0 или x & \footnotesize Спустя много дней считается легитимной\\ \hline
	\end{tabular}
\end{frame}

\begin{frame}{$AI^2$}
	Статья \textcolor{blue}{\href{https://yadi.sk/i/dJ-SrV4y3JFSPV}{<<$AI^2$: Training a big data machine to defined>>}} Kalyan Veeramachaneni, Ignacio Arnaldo и др.
	
	%\hspace{-36pt}
		\includegraphics[width=11.5cm]{../pic/ai2_first.png}	
\end{frame}


\begin{frame}{$AI^2$}
	\includegraphics[width=11.5cm]{../pic/ai2_second.png}
\end{frame}




\section{RSA Risk Engne}



\section{RSA Rules Engine}


  
\section{Вопросы для самопроверки}

\begin{frame}
	Прочитайте, что такое <<генетические алгоритмы>>(genetic algorithm).
	В чём роль обратной связи в них?
	
	Предложите структуру гена генетического алгоритма, создающий стратегии игры в крестики нолики. 
	
	Для желающих: реализуйте его (вместо какой-нибудь лабораторной). 
	<<стравите>> разные гены друг с другом и путём <<эволюции>>
	получите самый сильный алгоритм.
	
	Стал ли полученный алгоритм оптимальным? Сыграйте несколько партий. Сколько раз выиграли, 
	сколько проиграли, сколько раз сыграли вничью?
	
\end{frame}

\begin{frame}{Обратная связь и итеративное обучение}
	\begin{enumerate}
		\item В <<цепочке>> (см. слайд №\ref{frame:chain_score}) задана функция
		$\bold score$ с коэффициентами $(0.1, 0.2, 0.7)$. Каков будет скоринг, 
		если $score_1=540$, $score_2=546$, $dscore_3=584$?
		\item В <<цепочке>> задана функция 	$\bold score$ 
		с коэффициентами $(0.2, 0.4, 0.8)$. Значения $score_1, score_2, score_3$
		равны $345$, $124$ и $573$. Почему $\bold score$ 
		будет $412$, 
		а не $577$ ?
		\item Предположим, что $score_{i+1}$ 
		сильно больше чем $score_i$. Что это значит? 
		Действительно ли система работает нестабильно? 
		Приведите контрпримеры.
		
	\end{enumerate}
\end{frame}

\begin{frame}{RSA}
	\begin{itemize}
		\item На слайде №\ref{frame:rsa_feedback} не указаны действия
		обратной связи для ALLOW операции. Т.е. не производится никаких работ. 
		Почему?
		\item На слайде №\ref{frame:rsa_feedback} не указан процесс получения 
		по жалобам клиентов. По каким решениям ФМ системы возможны жалобы? 
		Приведите пример жалоб для ALLOW систем. 
		\item Почему если произошла операция DENY на правило "перевыпуск СИМ карт", 
		сотрудники коллцентра не могут разблокировать профиль позвонившим
		недовольным клиентам банка? Почему необходима либо более сложная аутентификация, чем 
		телефонный звонок?
	\end{itemize}
\end{frame}

\begin{frame}{RSA}
\begin{itemize}
	\item Почему большинство транзакций имеют CUSTOM\_MARK=Null ?
	(см. слайд №\ref{frame:custom_mark})
	\item Почему все непромаркированные операции (CUSTOM\_MARK=Null) спустя 10 и более дней считаются 
	легитимными в обучающей выборке?
\end{itemize}
\end{frame}

\end{document}